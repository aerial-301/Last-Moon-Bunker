'use strict';var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};function ba(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var ca=ba(this);
function da(a,b){if(b)a:{var c=ca;a=a.split(".");for(var f=0;f<a.length-1;f++){var e=a[f];if(!(e in c))break a;c=c[e]}a=a[a.length-1];f=c[a];b=b(f);b!=f&&null!=b&&aa(c,a,{configurable:!0,writable:!0,value:b})}}da("Object.values",function(a){return a?a:function(b){var c=[],f;for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&c.push(b[f]);return c}});let k,m,p,t,ea,fa,ia;let w,ja=[];const ta=()=>{w=y(z.A.width,100,"#533",10,0,z.A.height-100);m.g(w);const a=ka("Wall",10,10,28,13),b=ka("Unit",200,10,30,13);a.action=()=>{la=!0;z.wait(10,()=>C.visible=!0)};b.action=()=>{const c=ma(qa.x,qa.y);t.g(c);D.push(c);E.push(c);ra.push(c)};ja.push(a,b);w.g(a);w.g(b)};let ua,va,wa;const xa=()=>{ua=y(400,5,"black",8,100,20);ua.strokeStyle="darkgray";va=y(400,5,"Yellow",0,100,20);wa=y(400,5,"red",0,100,20);m.g(ua);m.g(va);m.g(wa);[ua,va,wa].forEach(a=>a.visible=!1)};let H,I;const K={w:!1,s:!1,a:!1,d:!1};window.addEventListener("keydown",a=>{a.key in K&&(K[a.key]=!0,I&&(H.L=!0))});window.addEventListener("keyup",a=>{a.key in K?(K[a.key]=!1,I&&Object.values(K).every(b=>!1===b)&&(H.L=!1)):"r"===a.key&&ya()});
const za=()=>{K.w&&(H.y-=H.speed,L("bot"),H.W(),t.children.sort((a,b)=>a.bottom-b.bottom));K.s&&(H.y+=H.speed,L("top"),H.W(),t.children.sort((a,b)=>a.bottom-b.bottom));K.a&&(H.x-=H.speed,L("right"),H.W());K.d&&(H.x+=H.speed,L("left"),H.W())},ya=()=>{I?(I=!1,[ua,va,wa].forEach(a=>a.visible=!1),w.visible=!0,H.ia||(H.L=!1,H.J.rotation=H.X,H=null)):1===M.length&&(I=!0,w.visible=!1,H=M[0],H.L=!1,H.target=null,N(Aa,H),N(O,H),H.Ca(),M.length=0,[ua,va,wa].forEach(a=>a.visible=!0),[va,wa].forEach(a=>{a.width=
H.v/H.K*400*H.ca}))};const Ba=Math.PI/180*-60,Ca=Math.PI/180*60;let La=!1;
const P=(a,b=0,c=0,f=50,e=50)=>{a.x=b;a.y=c;a.width=f;a.height=e;a.u=f/2;a.F=e/2;a.va=1;a.ba=1;a.Z=.5;a.$=.5;a.rotation=0;a.alpha=1;a.A=!1;a.visible=!0;a.children=[];a.parent=void 0;a.qb=void 0;a.g=d=>{d.parent&&d.parent.removeChild(d);d.parent=a;a.children.push(d)};a.removeChild=d=>{d.parent===a&&a.children.splice(a.children.indexOf(d),1)};Object.defineProperties(a,{o:{get:()=>a.x+(a.parent?a.parent.o:0)},l:{get:()=>a.y+(a.parent?a.parent.l:0)},C:{get:()=>a.o+a.u},D:{get:()=>a.l+a.F},bottom:{get:()=>
a.y+a.parent.l}})},Na=a=>{a.target=null;a.B=!1;a.Ia=!1;a.ia=!1;a.sa=0;a.ca=.5;a.M=y(a.v/a.K*100*a.ca,5,"Yellow");a.g(a.M);a.M.y=-10;a.N=y(a.v/a.K*100*a.ca,5,"green");a.g(a.N);a.N.y=-10;a.N.visible=!1;a.M.visible=!1;a.Eb=b=>{a!=H&&z.wait(Q(50,500),()=>{b.forEach(c=>{z.R(a,c)<a.ka&&(a.target=c,O.push(a))})})};a.ga=b=>{a.v-=b;a.Sa&&Ma(a.x,a.y);0>=a.v?(a.ia=!0,z.remove(a),N(E,a),N(O,a),a.Da()):(a.N.j=!0,a.M.j=!0,a.sa+=b*a.ca,a.N.width=a.v/a.K*100*a.ca,a.Ia||(a.Ia=!0,a.Va()),a.Ua())};a.Va=()=>{0<a.sa?
z.wait(30,()=>{a.M.width-=100/a.K;--a.sa;a.Va()}):(a.Ia=!1,a.N.j=!1,a.M.j=!1)};a.Da=()=>{N(D,a);N(ra,a)}},Sa=(a,b=0,c=0,f=0)=>{Oa(a,c,f);a.speed=2;a.O=Pa(5);a.aa=Pa(30);a.head=Qa();b&&(a.vb=Ra(),a.head.g(a.vb));a.m={};P(a.m,0,0,1,1);a.m.j=!0;a.J=a.m;a.Ea=!0;a.Ja=!0;a.g(a.O);a.O.y=a.height-a.O.height;a.g(a.aa);a.aa.y=a.height-a.aa.height;a.g(a.head);a.Sa=!0;a.xb=()=>{a.Xa||(a.Xa=!0,a.Ja&&(a.Ea=!0,a.Ja=!1,a.head.y=0,a.O.y=a.height-a.O.height,a.aa.y=a.height-a.aa.height,a.ua=0,a.ha=1),"MK"==a.type&&
(a.nb.y=a.G.y),a.G.y=a.head.y+("Pleb"==a.type?8:0),a.head.y+=a.ha,a.ua+=a.ha,2<=a.ua?--a.ha:-2>=a.ua&&(a.ha+=1),z.wait(50,()=>a.Xa=!1))};a.Bb=()=>{a.Za||(a.Za=!0,a.Ea&&(a.Ea=!1,a.Ja=!0,a.head.y=0,a.ta=0,a.V=5,a.$a=0,a.ab=0,a.bb=0),a.bb=a.ab,a.ab=a.$a,a.$a=a.O.y,a.ta+=a.V,a.O.y-=a.V,a.aa.y=a.bb,a.head.y=-Math.abs(a.V)-7,a.G.y=a.head.y+("Pleb"==a.type?10:0),"MK"==a.type&&(a.nb.y=a.G.y),15<=a.ta?a.V-=5:15>=a.ta&&(a.V+=5),z.wait(20,()=>a.Za=!1))};a.Ua=()=>{a.head.S=a.head.T="#FFF";z.wait(80,()=>{a.head.S=
"#222";a.head.T="#555"})};Na(a)},Ua=(a,b=1,c=0,f=0)=>{Sa(a,b,c,f);a.border=Ta();a.g(a.border);a.border.x-=a.u;a.border.y-=a.F;a.border.visible=!1;a.select=()=>{M.push(a);a.border.visible=!0;a.N.visible=!0;a.M.visible=!0};a.Ca=()=>{a.border.visible=!1;a.N.visible=!1;a.M.visible=!1}},Oa=(a,b=0,c=0)=>{a.speed=2;a.H=0;a.I=0;a.ea=b;a.fa=c;a.Na=!1;a.L=!1;a.P=[];a.zb=!1;a.Ob=!1;a.Ga=!1;a.Ha=!1;a.Qb=!1;a.Kb=!1;a.Lb=!1;a.Nb=!1;a.da=null;a.rb=null;a.move=()=>{var f=a.ea-a.x;var e=Math.abs(f);a.Ha?(a.x+=a.H*
a.speed,f=void 0):e>a.speed?(a.x+=a.H*a.speed,0<a.P.length&&0!=f&&Va(a,1),a.W(),f=!0):f=!1;e=Wa(a);f||e||(N(Aa,a),a.L=!1)};a.W=()=>{Xa(a)};P(a,b,c,50,50)},Ya=(a,b,c,f,e)=>{const d={content:b,font:c||"12px sans-serif",fillStyle:"#FFF",textBaseline:"top",h(g){g.fillStyle=this.fillStyle;0===d.width&&(d.width=g.measureText(d.content).width);0===d.height&&(d.height=g.measureText("M").width);g.translate(-d.width*d.Z,-d.height*d.$);g.font=d.font;g.textBaseline=d.textBaseline;g.fillText(d.content,0,0)}};
P(d,f,e,b.length,20);a.g(d)},db=()=>{let a;const b=Za(),c=$a(),f=y(2,140,"#FFF",0,0),e=y(4,40,"#0F0"),d=ab(1),g=ab(0),h={type:"MK",v:500,U:0,G:b,nb:c,lb:e,Rb:f,ib:d,jb:g,X:3,la:Ba,Db:10,Ma:10,Mb:!1};h.K=h.v;Ua(h,1,200,180);h.attack=()=>{a=-bb(h.m,z.i);h.B||h.ra?h.ra||(h.ra=!0,h.lb.rotation=a+Ba,h.Qa(Q(23,36)),h.jb.visible=!0,z.wait(40,()=>h.jb.visible=!1),z.wait(70,()=>h.ra=!1)):(h.B=!0,h.lb.rotation=a+Ca,h.rotation=0,h.Qa(Q(14,25)),h.ib.visible=!0,z.wait(40,()=>h.ib.visible=!1),z.wait(150,()=>h.B=
!1))};h.Qa=l=>{for(const B of R)if(175>=z.R(h.m,B)){var r=-bb(h.m,z.i);r+=2*S*(0>r);let u=-bb(h.m,B);u+=2*S*(0>u);r-=u;1.14>=Math.abs(r>S?2*S-r:r<-S?2*S+r:r)&&B.ga(l)}};h.fb=()=>{cb(h,h.H,h.I)};const n=h.m;h.g(b);h.g(c);c.g(n);n.g(e);e.x=-1;e.y=-21;e.g(f);f.x=e.u-f.u;f.y=e.height;n.j=!0;e.j=!0;f.j=!0;h.j=!0;f.g(d);d.x=-24.5;d.y=-25.5;f.g(g);g.x=-23.5;g.y=-25.5;f.ba*=-1;e.rotation=h.X;h.J=e;n.x=-1;n.y=28;return h},gb=a=>{a.attack=(b=z.i)=>{if(!a.B){a.B=!0;let c;if(a==H){c=10;if(0<R.length){La=!1;for(const f of R)if(z.R(b,
f)<f.u+5){f.ga(a.U);eb(1);La=!0;break}}La||eb(0)}else c=a.pb,a.J.rotation=-bb(a.m,b,a.pa,a.qa)+a.la,b.ga(a.U);a.J.tb();z.kb(220,.15,"sine",.15,180,20,2,[.09,.1,350]);z.wait(c,()=>a.B=!1)}};a.type="armedPleb";a.U=21;a.ka=700;a.pb=500;a.mb=R;a.la=S/2+.1;a.X=.4;fb(a);a.pa=-25;a.qa=-40},hb=a=>{const b=Za(0,8);a.type="Pleb";a.G=b;a.g(b);a.G.g(a.m)},ma=(a=0,b=0)=>{const c={v:100};c.K=c.v;Ua(c,0,a,b);hb(c);gb(c);return c},ib=()=>{const a={v:50};a.K=a.v;a.attack=()=>{};Ua(a,0,400,180);hb(a);return a},lb=
(a=0,b=0)=>{const c={type:"invader",v:100,U:9,ka:700,la:S/2,X:.4,mb:D};c.K=c.v;Sa(c,0,a,b);c.attack=f=>{c.B||(z.R(c,f)>c.ka?c.target=null:(c.B=!0,c.J.rotation=-bb(c.m,f,c.pa,c.qa)+c.la,c.Ka.Fb(z.R(c,f)),c.Ka.j=!0,c.j=!0,c.m.j=!0,c.G.j=!0,z.kb(4E3,.1,"square",.3,3500,0,0,[.1,.24,4E3]),f.ga(c.U),z.wait(25,()=>{c.Ka.j=!1;c.j=!1;c.m.j=!1;c.G.j=!1}),z.wait(800,()=>c.B=!1)))};c.Da=()=>{N(R,c)};c.G=kb();c.g(c.G);c.G.g(c.m);c.m.width=50;c.m.height=50;fb(c,!1);c.pa=-23;c.qa=-40;return c},eb=(a=1)=>{var b=
z.i.x-k.x,c=z.i.y-k.y;if(a)console.log("hit");else{const f=mb(b,c);p.g(f);nb.push(f);z.wait(170,()=>{z.remove(f);N(nb,f)})}};const ob=[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1]],bb=(a,b,c=0,f=0)=>Math.atan2(b.C+c-a.C,b.D+f-a.D),pb=(a,b,c)=>{var f=T;let e;ob.forEach(d=>{var g=[a,b];e=[g[0]+d[0],g[1]+d[1]];try{f[e[0]][e[1]]=c}catch(h){null}})},ka=(a,b=10,c=10,f=10,e=10,d=()=>console.log(a),g=170,h=80,n="#0F0")=>{b=y(g,h,n,1,b,c);b.action=d;Ya(b,a,`${90-8*a.length}px arial`,f,e);return b},Va=(a,b)=>{a.P.forEach(c=>{if(z.Fa(a,c)){var f=a.ea+k.x,e=a.fa+k.y;const d=c.C,g=c.D;void 0==a.da&&(a.da=c,Math.abs(f-d)<=c.u+
50&&Math.abs(e-g)<=c.F+50&&(a.ea=a.x,a.fa=a.y));b?(a.Ga=!0,a.x-=a.H*a.speed,a.I=e>g?.9:-.9):(a.Ha=!0,a.y-=a.I*a.speed,a.H=f>d?.9:-.9)}else c==a.da&&(a.da=void 0,b?a.Ga=!1:a.Ha=!1,a.Kb=!1,a.Lb=!1,c=a.ea-a.x,f=a.fa-a.y,e=Math.sqrt(Math.pow(c,2)+Math.pow(f,2)),a.H=c/e,a.I=f/e)})},L=a=>{var b=H;b.P&&b.P.forEach(c=>{if(z.Fa(b,c))switch(b.da=c,b.rb=a,a){case "top":b.y=c.y-b.height-1;break;case "bot":b.y=c.y+c.height+1;break;case "left":b.x=c.x-b.width-1;break;case "right":b.x=c.x+c.width+1}})},Q=(a,b,c=
1)=>{a=Math.random()*(b-a)+a;return c?Math.floor(a):a},N=(a,b)=>{b=a.indexOf(b);-1!==b&&a.splice(b,1)},qb=()=>{var a=H,b=z.i;let c;c=b.C-a.C;a=b.D-a.D;b=Math.sqrt(c**2+a**2);return{x:c/b,y:a/b}},rb=()=>{var a=M,b=z.i.x-k.x,c=z.i.y-k.y,f=Aa,e=a.length;if(0!=e){for(var d=Math.floor(Math.sqrt(e)),g=1;g<d;)if((e-g)%d!==d-1)g++;else break;a.sort((B,u)=>u.width-B.width);var h=a[0].width,n=a[0].height,l=(b+(e-g)%d*(h+4)+h-b)/2;e=(c+Math.floor((e-g)/d)*(n+4)+n-c)/2;for(let B in a){const u=a[B];u.zb=!1;u.target=
null;g=b+B%d*(h+20)-l;var r=c+Math.floor(B/d)*(n+10)-e;u.ea=g;u.fa=r;g-=u.x;r-=u.y;const sa=Math.sqrt(Math.pow(g,2)+Math.pow(r,2));u.H=g/sa;u.I=r/sa;-1==f.findIndex(J=>J==u)&&(u.L=!0,f.push(u))}}},Wa=a=>{t.children.sort((f,e)=>f.bottom-e.bottom);const b=a.fa-a.y,c=Math.abs(b);if(a.Ga)a.y+=a.I*a.speed;else return c>a.speed?(a.y+=a.I*a.speed,0<a.P.length&&0!=b&&Va(a,0),a.W(),!0):!1},Xa=a=>{if(!a.Na){a.Na=!0;for(const b of sb)400>Math.abs(b.C-a.C)&&400>Math.abs(b.D-a.D)?-1==a.P.findIndex(c=>c==b)&&a.P.push(b):
N(a.P,b);z.wait(400,()=>a.Na=!1)}},cb=(a,b,c)=>{0<a.Ma?z.wait(1,()=>{a.rotation+=.625;a.x+=b*a.speed*12.5;0<b?L("left"):0>b&&L("right");a.y+=c*a.speed*12.5;0<c?L("top"):0>c&&L("bot");--a.Ma;a.fb()}):(a.Ma=a.Db,a.rotation=0,a.Ya=!1)};let qa,T=[];const wb=()=>{const a=Math.floor(1E3/73),b=Math.floor(2400/73);for(var c=0;c<a;c++)T[c]=Array(b).fill(0);c=b/2;T[1][c]=5;pb(1,c,3);for(let f=0;f<a;f++)for(let e=0;e<b;e++)if(1==f%2&&(.5>Math.random()&&tb(73*e,73*f+Q(-73,73),Q(1,4),Q(0,5,0)),.3>Math.random()&&0==e%2&&0===T[f][e])){T[f][e]=4;pb(f,e,3);const d=Q(5,18.25);ub(d,73*e+d,73*f+d)}qa=vb(73*c);p.g(qa);sb.push(qa)};let V,xb,yb;
const zb=()=>{if(z.i.y>z.A.height-100)return!0},Bb=()=>{if(I)H.attack();else if(zb())ja.forEach(b=>{z.wb(b)&&b.action()});else if(la){const b=Math.floor((z.i.y-k.y)/73);if(!(0>b)){var a=Math.floor((z.i.x-k.x)/73);T[b][a]||(la=!1,T[b][a]=4,pb(b,a,3),a=Ab(a,b),a.x+=a.u/4,a.y+=a.F,p.g(a),sb.push(a),C.visible=!1)}}else xb=!0,V.alpha=1},Db=()=>{if(!I){if(!zb()&&(la&&(la=!1,C.visible=!1),0<M.length)){if(0<R.length)for(const c of R)if(25>=z.R(c,z.i)){const f=Cb();c.g(f);z.wait(300,()=>z.remove(f));M.forEach(e=>
{e.L=!1;e.target=c;O.push(e)});return}rb()}}else if("MK"==H.type&&!H.gb){H.gb=!0;var a=qb();H.H=a.x;H.I=a.y;var b=[];0<a.x?b.push("left"):b.push("right");0<a.y?b.push("top"):b.push("down");H.Ya=!0;H.W();H.fb();z.wait(200,()=>{H&&(H.gb=!1)})}},Eb=()=>{if(xb){M.forEach(f=>f.Ca());M.length=0;const a=V.na,b=V.ma,c=y(a?Math.abs(a):1,b?Math.abs(b):1,"#FFF",0,0>a?V.o+a:V.o,0>b?V.l+b:V.l);z.A.g(c);D.forEach(f=>{z.Fa(c,f,!0)&&-1==M.findIndex(e=>e==f)&&f.select()});xb=!1;V.alpha=0;yb=!1;z.wait(80,()=>z.remove(c))}};let Fb;const Gb=()=>{Fb||(Fb=document.getElementById("c"),Fb.addEventListener("contextmenu",a=>a.preventDefault()),Fb.addEventListener("pointerdown",a=>{0===a.button?Bb():2===a.button&&Db()}),Fb.addEventListener("pointerup",a=>{I?a=!1:(0===a.button&&Eb(),a=void 0);return a}))};let Hb=!1;const Ib=()=>{0<Aa.length&&!Hb&&(Hb=!0,Aa.forEach(a=>{a.L?a.move():N(Aa,a)}),z.wait(8,()=>Hb=!1))};const Jb=()=>{E.forEach(a=>{a.L?a.Bb():a.xb()})},Kb=()=>{0<nb.length&&nb.forEach(a=>{a.va+=.1;a.ba+=.1})},Mb=()=>{0<Lb.length&&Lb.forEach(a=>{a.x+=a.H;a.y+=a.I})},Ob=()=>{0<Nb.length&&Nb.forEach(a=>{.1<a.alpha?a.alpha-=.003:(z.remove(a),N(Nb,a))})};let Pb=!0,Qb=!0;const Sb=(a=!0)=>{a?Pb&&(Pb=!1,Rb(),z.wait(1400,()=>Pb=!0)):Qb&&(Qb=!1,Rb(R,D),z.wait(1100,()=>Qb=!0))},Rb=(a=ra,b=R)=>{a.forEach(c=>{c.target||c.Eb(b)})};const Tb=()=>{0<O.length&&O.forEach(a=>{!a.target||a.ia||a.target.ia?(N(O,a),a.target=null,z.wait(150,()=>a.J.rotation=a.X)):a.attack(a.target)})};let Ub=-1,Vb=-1,Wb=!1;var la=!1;const S=Math.PI;let Xb,D=[],z,E=[],ra=[],M=[],Aa=[],sb=[],R=[],nb=[],O=[],Lb=[],Nb=[],C;
const $b=()=>{var a=H;I?a.ia?ya():(Y.x=.5*(z.i.x+H.o+H.u),Y.x=.5*(H.o+H.u+Y.x),k.x-=.175*(Y.x-Yb)+.01,Y.y=.5*(z.i.y+H.l+H.F),Y.y=.5*(H.l+H.F+Y.y),k.y-=.175*(Y.y-Zb)+.01,a.B||a.ra||a.Ya||(za(),a.J.rotation=-bb(a.m,z.i,a.pa,a.qa)+a.la)):(xb&&(yb||(V.x=z.i.x,V.y=z.i.y,yb=!0),a=z.i.y-V.y,V.na=z.i.x-V.x,V.ma=a),K.w&&300>k.y&&(k.y+=10),K.s&&k.y>z.A.height-1E3&&(k.y-=10),K.a&&0>k.x&&(k.x+=10),K.d&&k.x>z.A.width-2400&&(k.x-=10));Ib();Jb();Kb();Mb();Ob();Sb();Sb(!1);Tb();if(la){const c=Math.floor(z.i.Hb/73),
f=Math.floor(z.i.Ib/73);c!=Ub&&(C.x=73*c-36.5,Ub=c,Wb=!0);f!=Vb&&(C.y=73*f-36.5,Vb=f,Wb=!0);if(Wb)if(console.log(f,c),Wb=!1,0>f)C.f="#F00";else{a:{a=T;try{if(!a[f][c]){var b=!0;break a}}catch(e){console.log("error")}b=!1}b?C.f="#FFF":C.f="#F00"}}};
z=function(a){function b(){requestAnimationFrame(b,e.canvas);if(void 0===e.Oa)e.state&&!e.paused&&e.state(),e.h(e.canvas,0);else{var d=Date.now(),g=d-e.Pa;1E3<g&&(g=e.oa);e.Pa=d;for(e.Y+=g;e.Y>=e.oa;)c(),e.state&&!e.paused&&e.state(),e.Y-=e.oa;e.h(e.canvas,e.Y/e.oa)}}function c(){function d(g){g.ya=g.x;g.za=g.y;g.children&&0<g.children.length&&g.children.forEach(h=>d(h))}e.A.children.forEach(g=>d(g))}function f(d,g=0,h=0,n=50,l=50){d.x=g;d.y=h;d.width=n;d.height=l;d.u=n/2;d.F=l/2;d.va=1;d.ba=1;d.Z=
.5;d.$=.5;d.rotation=0;d.alpha=1;d.A=!1;d.visible=!0;d.children=[];d.parent=void 0;d.qb=void 0;d.g=r=>{r.parent&&r.parent.removeChild(r);r.parent=d;d.children.push(r)};d.removeChild=r=>{r.parent===d&&d.children.splice(d.children.indexOf(r),1)};Object.defineProperties(d,{o:{get:()=>d.x+(d.parent?d.parent.o:0)},l:{get:()=>d.y+(d.parent?d.parent.l:0)},C:{get:()=>d.o+d.u},D:{get:()=>d.l+d.F},bottom:{get:()=>d.y+d.parent.l}})}var e={};e.canvas=document.getElementById("c");e.canvas.style.backgroundColor=
"black";e.canvas.sb=e.canvas.getContext("2d");e.A=function(){const d={};f(d,0,0,e.canvas.width,e.canvas.height);d.A=!0;d.parent=void 0;return d}();e.i=function(){let d={Aa:0,Ba:0};Object.defineProperties(d,{x:{get:()=>d.Aa/e.scale},y:{get:()=>d.Ba/e.scale},o:{get:()=>d.x},l:{get:()=>d.y},u:{get:()=>0},F:{get:()=>0},C:{get:()=>d.x},D:{get:()=>d.y},Hb:{get:()=>d.Aa-k.x},Ib:{get:()=>d.Ba-k.y}});d.Cb=function(g){d.Aa=g.pageX-g.target.offsetLeft;d.Ba=g.pageY-g.target.offsetTop;g.preventDefault()};e.canvas.addEventListener("mousemove",
d.Cb.bind(d),!1);return d}();e.state=void 0;e.Gb=a;e.paused=!1;e.Oa=60;e.Pa=Date.now();e.oa=1E3/e.Oa;e.Y=0;e.yb=!0;e.scale=1;e.h=(d,g)=>{function h(l){if(l.j||l.visible&&l.o<d.width+l.width&&l.o+l.width>=-l.width&&l.l<d.height+l.height&&l.l+l.height>=-l.height)n.save(),e.yb?(l.cb=void 0!==l.ya?(l.x-l.ya)*g+l.ya:l.x,l.eb=void 0!==l.za?(l.y-l.za)*g+l.za:l.y):(l.cb=l.x,l.eb=l.y),n.translate(l.cb+l.width*l.Z,l.eb+l.height*l.$),n.globalAlpha=l.alpha,n.rotate(l.rotation),n.scale(l.va,l.ba),l.h&&l.h(n),
l.children&&0<l.children.length&&(n.translate(-l.width*l.Z,-l.height*l.$),l.children.forEach(r=>h(r))),n.restore()}let n=d.sb;n.clearRect(0,0,d.width,d.height);e.A.children.forEach(l=>h(l))};e.start=()=>{e.Gb();b()};e.pause=()=>e.paused=!0;e.resume=()=>e.paused=!1;e.remove=function(){let d=Array.prototype.slice.call(arguments);d[0]instanceof Array||(1<d.length?d.forEach(g=>g.parent.removeChild(g)):d[0].parent.removeChild(d[0]))};e.group=function(d){const g={};f(g);g.g=h=>{h.parent&&h.parent.removeChild(h);
h.parent=g;g.children.push(h);g.Ra()};g.removeChild=h=>{h.parent==g&&g.children.splice(g.children.indexOf(h),1);g.Ra()};g.Ra=()=>{0<g.children.length&&(g.xa=0,g.wa=0,g.children.forEach(h=>{h.x+h.width>g.xa&&(g.xa=h.x+h.width);h.y+h.height>g.wa&&(g.wa=h.y+h.height)}),g.width=g.xa,g.height=g.wa)};e.A.g(g);d&&Array.prototype.slice.call(arguments).forEach(h=>g.g(h));return g};e.wait=(d,g)=>setTimeout(g,d);e.Fa=(d,g,h=!1)=>{let n,l;h?(n=d.o+d.u-(g.o+g.u),l=d.l+d.F-(g.l+g.F)):(n=d.C-g.C,l=d.D-g.D);h=d.u+
g.u;d=d.F+g.F;return Math.abs(n)<h?Math.abs(l)<d?!0:!1:!1};e.wb=function(d){var g=z.i;return g.x<d.o||g.x>d.o+d.width||g.y<d.l||g.y>d.l+d.height?!1:!0};e.R=(d,g)=>Math.sqrt(Math.pow(g.C-(d.C+0),2)+Math.pow(g.D-(d.D+0),2));e.ob=new AudioContext;e.kb=function(d,g,h,n,l,r,B,u){function sa(v,x){return Math.floor(Math.random()*(x-v+1))+v}var J=0,na=0,F=0,Da=!1,W;function Ea(v){for(var x=q.createConvolver(),A=W[1],G=W[2],oa=q.sampleRate*W[0],Fa=q.createBuffer(2,oa,q.sampleRate),ac=Fa.getChannelData(0),
bc=Fa.getChannelData(1),ha=0;ha<oa;ha++){var jb=G?oa-ha:ha;ac[ha]=(2*Math.random()-1)*Math.pow(1-jb/oa,A);bc[ha]=(2*Math.random()-1)*Math.pow(1-jb/oa,A)}x.buffer=Fa;v.connect(x);x.connect(U)}function Ga(v){var x=q.createGain(),A=q.createDelay(),G=q.createBiquadFilter();A.delayTime.value=u[0];x.gain.value=u[1];u[2]&&(G.frequency.value=u[2]);A.connect(x);u[2]?(x.connect(G),G.connect(A)):x.connect(A);v.connect(A);A.connect(U)}function Ha(v){v.gain.value=0;v.gain.linearRampToValueAtTime(0,q.currentTime+
F);v.gain.linearRampToValueAtTime(n,q.currentTime+F+J)}function Ia(v){v.gain.linearRampToValueAtTime(n,q.currentTime+J+F);v.gain.linearRampToValueAtTime(0,q.currentTime+F+J+g)}function Ja(v){var x=v.frequency.value;Da?(v.frequency.linearRampToValueAtTime(x,q.currentTime+F),v.frequency.linearRampToValueAtTime(x+l,q.currentTime+F+J+g)):(v.frequency.linearRampToValueAtTime(x,q.currentTime+F),v.frequency.linearRampToValueAtTime(x-l,q.currentTime+F+J+g))}function cc(){var v=q.createOscillator(),x=q.createOscillator(),
A=q.createGain(),G=q.createGain();A.gain.value=n;G.gain.value=n;v.connect(A);A.connect(q.destination);x.connect(G);G.connect(q.destination);v.type="sawtooth";x.type="sawtooth";v.frequency.value=Ka+B;x.frequency.value=Ka-B;0<J&&(Ha(A),Ha(G));0<g&&(Ia(A),Ia(G));0<l&&(Ja(v),Ja(x));u&&(Ga(A),Ga(G));W&&(Ea(A),Ea(G));v.start(q.currentTime+F);x.start(q.currentTime+F)}void 0===d&&(d=200);void 0===J&&(J=0);void 0===g&&(g=1);void 0===h&&(h="sine");void 0===n&&(n=1);void 0===na&&(na=0);void 0===F&&(F=0);void 0===
l&&(l=0);void 0===Da&&(Da=!1);void 0===r&&(r=0);void 0===B&&(B=0);void 0===u&&(u=void 0);void 0===W&&(W=void 0);var q=e.ob,U;var pa=q.createOscillator();var X=q.createGain();q.createStereoPanner?U=q.createStereoPanner():U=q.createPanner();pa.connect(X);X.connect(U);U.connect(q.destination);X.gain.value=n;q.createStereoPanner?U.pan.value=na:U.setPosition(na,0,1-Math.abs(na));pa.type=h;var Ka=0<r?sa(d-r/2,d+r/2):d;pa.frequency.value=Ka;0<J&&Ha(X);Ia(X);0<l&&Ja(pa);u&&Ga(X);W&&Ea(X);0<B&&cc();pa.start(q.currentTime+
F)};return e}(()=>{Gb();ea=dc();fa=ec();ia=fc();p=z.group();t=z.group();k=z.group(ea,fa,ia,p,t);m=z.group();wb();C=gc();ta();Xb=db();t.g(Xb);D.push(Xb);E.push(Xb);var a=lb(300,180);t.g(a);E.push(a);for(a=0;7>a;a++){const b=lb(1400+50*a,350);t.g(b);E.push(b);R.push(b)}a=ma(275,250);t.g(a);D.push(a);E.push(a);a=ib();t.g(a);D.push(a);E.push(a);yb=xb=!1;V=hc();V.alpha=0;m.g(V);xa();t.children.sort((b,c)=>b.bottom-c.bottom);Yb=z.A.width/2;Zb=z.A.height/2;Y=y(1,1,"",0);Y.alpha=0;z.state=$b});z.start();const Z=Math.PI,dc=()=>{const a={fillStyle:"#fb0",ja:65,h:b=>{b.lineWidth=0;b.fillStyle=a.fillStyle;b.beginPath();b.arc(a.ja+2*-a.ja*a.Z,a.ja+2*-a.ja*a.$,a.ja,0,2*Z,!1);b.fill()}};P(a,500,-250,130,130);return a},y=(a,b,c,f=1,e=0,d=0)=>{const g={x:e,y:d,width:a,height:b,fillStyle:c,strokeStyle:"black",h:h=>{h.strokeStyle=g.strokeStyle;h.lineWidth=f;h.fillStyle=g.fillStyle;h.beginPath();h.moveTo(e,d);h.rect(-g.width*g.Z,-g.height*g.$,g.width,g.height);h.fill();f&&h.stroke()}};P(g,e,d,a,b);return g},
hc=()=>{const a={na:1,ma:1,h(b){b.strokeStyle="#FFF";b.lineWidth=4;b.beginPath();b.rect(a.na,a.ma,-a.na,-a.ma);b.stroke()}};P(a,0,0,1,1);return a},ab=a=>{const b={h(c){c.fillStyle="#fff";a?(c.beginPath(),c.arc(0,160,160,1.5*Z,.165*Z,!1),c.arc(65,195,85,.165*Z,1.225*Z,!0)):(c.beginPath(),c.arc(0,160,160,1.5*Z,.835*Z,!0),c.arc(-65,195,85,.835*Z,1.772*Z,!1));c.fill()}};P(b,0,0);b.visible=!1;return b},Za=(a=0,b=0)=>{const c={h(f){f.lineJoin="round";f.strokeStyle="#000";f.fillStyle="red";f.lineWidth=.7;
f.beginPath();f.moveTo(-18,-10);f.lineTo(-4,0);f.lineTo(-18,-5);f.lineTo(-18,-10);f.fill();f.moveTo(18,-10);f.lineTo(4,0);f.lineTo(18,-5);f.lineTo(18,-10);f.fill();f.stroke()}};P(c,a,b);return c},$a=()=>{const a={h(b){b.strokeStyle="#000";b.fillStyle="red";b.lineWidth=.8;b.beginPath();b.moveTo(-3,-18);b.lineTo(3,-18);b.lineTo(0,-3);b.lineTo(-3,-18);b.fill();b.stroke()}};P(a);return a},Pa=a=>{const b={h(c){c.strokeStyle="#000";c.fillStyle="#555";c.lineWidth=1;c.beginPath();c.moveTo(0,0);c.lineTo(6,
0);c.lineTo(6,4);c.lineTo(0,4);c.lineTo(0,0);c.fill();c.stroke()}};P(b,a,0,7,5);return b},Ta=()=>{const a={h(b){b.strokeStyle="#FFF";b.lineWidth=2;b.beginPath();b.moveTo(0,0);b.lineTo(12.5,0);b.moveTo(37.5,0);b.lineTo(50,0);b.lineTo(50,12.5);b.moveTo(50,37.5);b.lineTo(50,50);b.lineTo(37.5,50);b.moveTo(12.5,50);b.lineTo(0,50);b.lineTo(0,37.5);b.moveTo(0,12.5);b.lineTo(0,0);b.stroke()}};P(a,0,0,50,50);return a},Ra=()=>{const a={h(b){b.strokeStyle="#000";b.lineWidth=1.5;b.beginPath();b.arc(-12,-13,35,
.2*Math.PI,.4*Math.PI,!1);b.stroke();b.beginPath();b.arc(20,-5,22,.55*Math.PI,.85*Math.PI,!1);b.stroke();b.beginPath();b.arc(17,-3,22,.55*Math.PI,.85*Math.PI,!1);b.stroke()}};P(a,0,0);return a},Qa=()=>{const a={S:"#222",T:"#555",h:b=>{const c=b.createRadialGradient(2,-3,27,10,-20,0);c.addColorStop(0,a.S);c.addColorStop(.1,a.T);b.strokeStyle="#000";b.fillStyle=c;b.lineWidth=2;b.beginPath();b.arc(0,0,25,0,2*Z,!1);b.stroke();b.fill()}};P(a);return a.head=a},mb=(a,b)=>{const c={h(f){f.strokeStyle="#F00";
f.fillStyle="#FF0";f.lineWidth=4;f.beginPath();f.arc(-1,-1,2,0,2*Z,!1);f.stroke();f.fill()}};P(c,a,b,4,4);return c},ic=()=>{const a={h(b){b.strokeStyle="#F00";b.fillStyle="#FF0";b.lineWidth=2;b.beginPath();b.lineTo(0,1);b.lineTo(50,0);b.lineTo(0,-1);b.stroke();b.fill()}};P(a,0,0);a.visible=!1;return a},Cb=()=>{const a={h(b){b.lineWidth=8;b.beginPath();b.strokeStyle="#F00";b.arc(20,22,35,0,2*Z,!1);b.stroke()}};P(a,0,0,10,10);return a},fc=()=>{const a={h(b){const c=b.createLinearGradient(0,0,-100,500);
c.addColorStop(0,"#444");c.addColorStop(.2,"#333");c.addColorStop(1,"#222");b.beginPath();b.rect(-1200,-500,2400,1E3);b.fillStyle=c;b.fill()}};P(a,0,0,2400,1E3);return a},vb=a=>{const b={h(c){c.lineWidth=5;c.fillStyle="#900";c.beginPath();c.rect(-36.5,-36.5,73,73);c.stroke();c.fill();c.fillStyle="#000";c.fillRect(-32,-32,64,64);c.fillStyle="#888";c.fillRect(30,30,-21,-52);c.fillRect(8,30,-21,-42);c.fillRect(-14,30,-16,-32)}};P(b,a,73,73,73);return b},Ab=(a,b)=>{const c=73*.8,f={La:4,color:"#000",
h(d){d.lineWidth=1;d.strokeStyle="#999";d.fillStyle=this.color;d.beginPath();d.arc(0,0,this.La,0,2*Z);d.fill();d.stroke()}},e={hb:b,Ta:a,v:100,K:100,ka:1E3,U:37,type:"Building",S:"#333",T:"#111",Pb:"#333",J:{rotation:0},X:0,mb:R};P(f,0,0,c,.6*c);P(e,73*a,73*b,c,.6*c);e.h=d=>{const g=d.createLinearGradient(c,0,0,c);g.addColorStop(0,e.S);g.addColorStop(1,e.T);d.fillStyle=g;d.lineWidth=2;d.beginPath();d.ellipse(0,.3*c,c/2,c/2,0,0,Z,!0);d.closePath();d.fill();d.stroke()};e.attack=d=>{e.B||(z.R(e,d)>e.ka?
e.target=null:(e.B=!0,f.La=8,f.color="#ff0",d.ga(e.U),z.wait(50,()=>{f.La=4;f.color="#000"}),z.wait(500,()=>e.B=!1)))};Na(e);e.select=()=>{};e.Ca=()=>{};e.Ua=()=>{e.S=e.T="#FFF";z.wait(80,()=>{e.S="#333";e.T="#111"})};e.Da=()=>{N(D,e);N(ra,e);N(sb,e);T[e.hb][e.Ta]=0;pb(e.hb,e.Ta,0)};e.Sa=!1;e.g(f);D.push(e);ra.push(e);return e},gc=()=>{const a={f:"#FFF"};P(a,0,0,73,73);a.h=b=>{b.fillStyle=a.f;b.lineWidth=2;b.beginPath();b.fillRect(0,0,73,73)};a.alpha=.4;a.visible=!1;k.g(a);return a},ub=(a,b,c)=>{const f=
[0,0,a,a/2,0,0,2*Z,!0],e=[-.15*a,.45*a,a,a/1.2,0,0,2*Z,!1];var d={h(n){n.strokeStyle="#333";n.beginPath();n.ellipse(...f);n.fillStyle="#222";n.fill();n.stroke()}};let g=new Path2D;g.ellipse(...f);const h={h(n){n.lineWidth=3;n.strokeStyle="#333";n.beginPath();n.ellipse(...f);n.stroke();n.clip(g);n.ellipse(...e);n.fillStyle="#555";n.fill()}};P(h,b,c,a,a);P(d,b,c,a,a);p.g(d);p.g(h);d.rotation=Z;h.rotation=Z;d={};P(d,Math.floor(b-a/1.8),Math.floor(c-.1*a),Math.floor(2.2*a),Math.floor(1.2*a));t.g(d);sb.push(d)},
tb=(a,b,c=2,f=0)=>{var e=Q(10,170,0);const d={h(g){g.lineWidth=c;g.strokeStyle="#000";g.lineJoin="round";g.lineCap="round";g.beginPath();g.ellipse(0,0,e/2,f,0,Z,2*Z,!1);g.stroke()}};P(d,a,b,e,10);d.alpha-=.3*c;p.g(d);d.rotation=Q(-.15,.15,0)},jc=()=>{const a={length:10,h(b){b.strokeStyle="#F00";b.lineWidth=2;b.beginPath();b.moveTo(0,0);b.lineTo(this.length,0);b.stroke()},Fb(b){this.length=b-40}};P(a,0,0,100,100);a.visible=!1;return a},fb=(a,b=!0)=>{const c={h(e){e.lineWidth=2;e.beginPath();e.moveTo(-55,
-30);e.fillStyle="#000";e.fillRect(-35,-2.5,70,5);e.fillStyle="#222";e.fillRect(-7,2.5,-7,17);e.stroke();e.fill()}};P(c,-55,-30,150,150);const f={h(e){e.lineWidth=2;e.beginPath();e.moveTo(-55,-30);e.fillStyle="#433";e.rect(-2,-5,4,10);e.stroke();e.fill()},tb:()=>{f.Wa.j=!0;z.wait(25,()=>f.Wa.j=!1)}};P(f,-55,-30,150,150);f.j=!0;f.g(c);c.y=-8;c.x=23;a.m.g(f);a.J=f;a.J.rotation=a.X;b?(a=ic(),f.g(a),f.Wa=a,a.x=108,a.y=42):(b=jc(),f.g(b),b.x=82.5,b.y=17,a.Ka=b)},ec=()=>{const a={h(c){c.beginPath();c.arc(0,
0,150,0,2*Z,!1);c.fillStyle="#00F";c.fill()}},b={h(c){c.beginPath();c.fillStyle="#080";c.moveTo(-2,-35);c.lineTo(75,-28);c.lineTo(75,15);c.lineTo(24,65);c.moveTo(25,100);c.lineTo(35,70);c.lineTo(80,100);c.lineTo(50,180);c.lineTo(38,120);c.moveTo(220,120);c.lineTo(190,60);c.lineTo(150,45);c.lineTo(170,0);c.lineTo(240,0);c.lineTo(260,40);c.fill()}};P(b,260,-200,150,150);P(a,260,-200,150,150);a.g(b);b.x=-120;b.y=-50;return a},kb=()=>{const a={h(b){b.strokeStyle="#000";b.fillStyle="#0F0";b.lineWidth=
2;b.beginPath();b.ellipse(0,-10,10,10,0,0,2*Z,!1);b.stroke();b.fill()}};P(a,0,0);return a},Ma=(a,b)=>{const c={Ab:3,H:Q(-.5,.5,!1),I:2,h:f=>{f.strokeStyle="#000";f.fillStyle="#700";f.lineWidth=2;f.beginPath();f.ellipse(0,-10,3,c.Ab,0,0,2*Z,!1);f.stroke();f.fill()}};P(c,a,b);k.g(c);Lb.push(c);z.wait(Q(300,450),()=>{z.remove(c);N(Lb,c);kc(c.x,c.y)})},kc=(a,b)=>{const c={ub:Q(15,40),Jb:Q(3,7),h:f=>{f.fillStyle="#700";f.beginPath();f.ellipse(0,-10,c.ub,c.Jb,0,0,2*Z,!1);f.fill()}};P(c,a,b);p.g(c);Nb.push(c)};let Y,Yb,Zb;//# sourceMappingURL=main.js.map 